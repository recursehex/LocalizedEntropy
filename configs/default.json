{
  "project": {
    "seed": 42
  },
  "experiment": {
    "active": "bce_baseline",
    "overrides": {},
    "definitions": {
      "baseline": {},
      "bce_baseline": {
        "training": {
          "loss_mode": "both"
        }
      },
      "small_net": {
        "training": {
          "epochs": 8,
          "batch_size": 10000
        },
        "model": {
          "hidden_sizes": [
            128,
            64
          ],
          "embed_dim": 8,
          "dropout": 0.2
        }
      }
    }
  },
  "device": {
    "move_dataset_to_cuda": true,
    "allow_dataloader_workers": false,
    "num_workers_env": "LOCALIZED_ENTROPY_NUM_WORKERS"
  },
  "training": {
    "epochs": 6,
    "lr": 0.001,
    "batch_size": 25000,
    "loss_mode": "localized_entropy",
    "eval_every_n_batches": 0,
    "eval_compare_losses": [
      "localized_entropy",
      "bce"
    ]
  },
  "model": {
    "hidden_sizes": [
      256,
      256,
      128,
      64
    ],
    "embed_dim": 16,
    "cat_embed_dim": 8,
    "dropout": 0.3
  },
  "data": {
    "source": "ctr",
    "train_split": 0.9,
    "standardize": true,
    "standardize_eps": 1e-06,
    "shuffle_test": true
  },
  "ctr": {
    "train_path": "data/train_top3.csv",
    "test_path": "data/test.csv",
    "read_rows": 10000000,
    "numeric_cols": [],
    "categorical_cols": [
      "C1",
      "hour",
      "banner_pos",
      "device_type",
      "device_conn_type",
      "site_id",
      "site_domain",
      "app_id",
      "app_domain",
      "app_category",
      "device_id",
      "device_model",
      "C14",
      "C15",
      "C16",
      "C17",
      "C18",
      "C19",
      "C20",
      "C21"
    ],
    "categorical_max_values": 1000,
    "derived_time": true,
    "device_counters": true,
    "device_counter_cap": 8,
    "condition_col": "C14",
    "label_col": "click",
    "weight_col": null,
    "max_conditions": 50,
    "filter_col": null,
    "filter_top_k": 0,
    "drop_na": true,
    "plot_filter_stats": true,
    "filter_test": true,
    "test_has_labels": false,
    "plot_sample_size": 200000,
    "balance_by_condition": true
  },
  "synthetic": {
    "num_conditions": 6,
    "min_samples_per_condition": 200000,
    "max_samples_per_condition": 200000,
    "num_numeric_features": 2,
    "base_mu_ln": 10.0,
    "base_sigma_ln": 1.5,
    "sigmoid_mu_range": [
      5.0,
      7.0,
      50
    ],
    "sigmoid_s_range": [
      0.2,
      0.3,
      50
    ],
    "age_mu_range": [
      30.0,
      70.0,
      50
    ],
    "age_sigma_range": [
      10.0,
      30.0,
      50
    ],
    "interest_scale_log10_range": [
      0.0,
      0.001,
      50
    ],
    "age_min": 10,
    "age_max": 100,
    "extra_feature_dist": {
      "mean": 0.0,
      "std": 1.0
    }
  },
  "plots": {
    "data_before_training": true,
    "data_after_training": true,
    "eval_hist_epochs": false,
    "loss_curves": true,
    "eval_pred_hist": true,
    "eval_pred_by_condition": true,
    "eval_pred_value_range": [
      -12,
      0
    ],
    "le_stats": true,
    "print_eval_summary": true,
    "print_le_stats_table": true,
    "ctr_data_distributions": true,
    "ctr_label_rates": true,
    "ctr_max_features": 3,
    "ctr_log10_features": [],
    "ctr_use_density": false
  },
  "logging": {
    "print_loader_note": true
  },
  "evaluation": {
    "use_test_labels": false,
    "split": "eval",
    "ece_bins": 20,
    "ece_min_count": 1,
    "small_prob_max": 0.01,
    "per_ad_top_k": 10,
    "print_per_ad": true,
    "print_calibration_table": false,
    "small_prob_quantile": 0.1
  },
  "comparison": {
    "enabled": true,
    "top_k": 20,
    "sort_by": "count",
    "print_table": true
  }
}